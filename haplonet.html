<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Haplonet-Inator‚Ñ¢Ô∏è - Nexusficadorinator-inator‚Ñ¢Ô∏è</title>
    <link rel="stylesheet" href="haplonet.css" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ñ</text></svg>"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <!-- Pickr Color Picker -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/monolith.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>
    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <h1>
          <i
            class="fa-solid fa-robot"
            style="font-size: 2.5rem; vertical-align: middle"
          ></i>
          Haplonet-Inator<sup>‚Ñ¢</sup>
        </h1>
        <p class="subtitle">
          Visualize e analise redes de hapl√≥tipos com algoritmo Median-Joining
        </p>
        <a href="index.html" class="back-link">
          <ion-icon name="arrow-back"></ion-icon>
          Voltar ao Conversor
        </a>
      </header>

      <main class="main-content">
        <!-- Upload Section -->
        <section id="uploadSection" class="section">
          <div class="upload-card">
            <h2>Carregar Dados FASTA</h2>
            <p class="subtitle">
              Envie seu arquivo FASTA alinhado para gerar a rede de hapl√≥tipos
            </p>

            <div class="drop-zone" id="dropZone">
              <ion-icon name="cloud-upload" class="drop-icon"></ion-icon>
              <p>Arraste seu arquivo FASTA aqui</p>
              <span class="drop-text">ou</span>
              <button class="btn-primary" id="selectFileBtn">
                <ion-icon name="folder-open"></ion-icon>
                Selecionar arquivo
              </button>
              <input
                type="file"
                id="fastaInput"
                accept=".fas,.fasta,.fa,.txt"
                hidden
              />
            </div>

            <div class="file-card" id="fileCard" style="display: none">
              <div class="file-info">
                <ion-icon name="document-text"></ion-icon>
                <div>
                  <div class="file-name" id="fileName"></div>
                  <div class="file-size" id="fileSize"></div>
                </div>
              </div>
              <button
                class="btn-icon"
                id="removeFileBtn"
                title="Remover arquivo"
              >
                <ion-icon name="close-circle"></ion-icon>
              </button>
            </div>

            <div class="file-stats" id="fileStats" style="display: none">
              <div class="stat">
                <span class="stat-label">Sequ√™ncias:</span>
                <span class="stat-value" id="seqCount">0</span>
              </div>
              <div class="stat">
                <span class="stat-label">Comprimento:</span>
                <span class="stat-value" id="seqLength">0</span>
              </div>
              <div class="stat">
                <span class="stat-label">Hapl√≥tipos:</span>
                <span class="stat-value" id="hapCount">0</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Network Options -->
        <section id="optionsSection" class="section" style="display: none">
          <div class="options-card">
            <h2>Localidades detectadas:</h2>

            <!-- Location Selection -->
            <div
              class="location-config"
              id="locationConfig"
              style="display: none"
            >
              <div id="locationSelection"></div>
            </div>

            <button class="btn-primary btn-large" id="generateNetworkBtn">
              <ion-icon name="git-network"></ion-icon>
              Gerar Rede de Hapl√≥tipos
            </button>
          </div>
        </section>

        <!-- Network Visualization -->
        <section id="networkSection" class="section" style="display: none">
          <div class="network-card">
            <div class="network-header">
              <div class="network-title-row">
                <h2>üï∏Ô∏è Rede de Hapl√≥tipos</h2>
                <div class="network-actions">
                  <button class="btn-secondary" id="exportPNGBtn">
                    <ion-icon name="download"></ion-icon>
                    Exportar PNG
                  </button>
                  <button class="btn-secondary" id="exportSVGBtn">
                    <ion-icon name="code-download"></ion-icon>
                    Exportar SVG
                  </button>
                  <button class="btn-secondary" id="resetLayoutBtn">
                    <ion-icon name="refresh"></ion-icon>
                    Resetar Layout
                  </button>
                </div>
              </div>
            </div>

            <div class="canvas-container">
              <canvas id="networkCanvas"></canvas>
              <div
                style="
                  position: absolute;
                  bottom: 10px;
                  right: 10px;
                  background: rgba(0, 0, 0, 0.7);
                  color: white;
                  padding: 0.5rem 1rem;
                  border-radius: 0.5rem;
                  font-size: 0.875rem;
                "
              >
                <strong>üí° Dica:</strong> Arraste os n√≥s para reposicionar ‚Ä¢
                Scroll para zoom ‚Ä¢ Clique e arraste o fundo para mover
              </div>
            </div>

            <div class="network-header">
              <div class="network-title-row">
                <div class="network-stats">
                  <span class="stat-inline"
                    ><strong>N√≥s:</strong> <span id="nodeCount">0</span></span
                  >
                  <span class="stat-inline"
                    ><strong>Conex√µes:</strong>
                    <span id="edgeCount">0</span></span
                  >
                  <span class="stat-inline"
                    ><strong>Componentes:</strong>
                    <span id="componentCount">0</span></span
                  >
                </div>
                <div class="network-toggles">
                  <button
                    class="mutation-toggle"
                    id="mutationToggle"
                    title="Alternar entre n√∫meros e tra√ßos"
                  >
                    <span class="toggle-track">
                      <span class="toggle-thumb"></span>
                      <span class="toggle-label left">123</span>
                      <span class="toggle-label right">|||</span>
                    </span>
                  </button>
                  <label class="checkbox-toggle">
                    <input type="checkbox" id="showMutations" checked />
                    <span class="toggle-slider"></span>
                    <span class="toggle-text">Muta√ß√µes</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Legend -->
            <div class="legend" id="legend" style="display: none">
              <div class="legend-header">
                <h3>Legenda</h3>
                <div class="legend-global-colors">
                  <div class="pickr-wrapper" title="Cor de fundo">
                    <div id="backgroundColor" class="color-picker"></div>
                  </div>
                  <div class="pickr-wrapper" title="Cor das conex√µes">
                    <div id="edgeColor" class="color-picker"></div>
                  </div>
                  <div class="pickr-wrapper" title="Cor das muta√ß√µes">
                    <div id="mutationColor" class="color-picker"></div>
                  </div>
                  <div class="pickr-wrapper" title="Cor dos medianos">
                    <div id="medianColor" class="color-picker"></div>
                  </div>
                </div>
              </div>
              <div id="legendContent"></div>
            </div>
          </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
          <p>
            <ion-icon name="information-circle-outline"></ion-icon>
            Sistema desenvolvido para an√°lises filogen√©ticas e filogeogr√°ficas
          </p>
          <div
            style="
              display: flex;
              gap: 1rem;
              align-items: center;
              flex-wrap: wrap;
              justify-content: center;
            "
          >
            <a href="./README.md" target="_blank" class="footer-link">
              <ion-icon name="help-circle-outline"></ion-icon>
              Ver documenta√ß√£o
            </a>
            <a href="./index.html" class="footer-link">
              <ion-icon name="swap-horizontal-outline"></ion-icon>
              Nexusficador-inator‚Ñ¢
            </a>
          </div>
          <p>
            <a
              href="https://bontempoweb.com"
              rel="nofollow"
              target="_blank"
              class="hover:text-white transition"
            >
              Feito por BontempoWeb
            </a>
          </p>
        </footer>
      </main>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="spinner-overlay" style="display: none">
      <div class="spinner"></div>
      <p>Processando...</p>
    </div>

    <!-- Error Display -->
    <div id="errorDisplay" class="error-banner" style="display: none">
      <ion-icon name="alert-circle"></ion-icon>
      <span id="errorMessage"></span>
      <button
        class="error-close"
        onclick="document.getElementById('errorDisplay').style.display='none'"
      >
        <ion-icon name="close"></ion-icon>
      </button>
    </div>

    <!-- Toast -->
    <div id="successToast" class="toast" style="display: none">
      <ion-icon name="checkmark-circle"></ion-icon>
      <span id="toastMessage"></span>
    </div>

    <!-- Tooltip -->
    <div id="tooltip" class="tooltip" style="display: none"></div>

    <script src="haplonet.js"></script>
  </body>
</html>
